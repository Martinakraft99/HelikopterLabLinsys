Vs0 = 5.48;

Kf = -(l_c*g*m_c - l_h*g*2*m_p)/(l_h*Vs0);

K1 = l_p*Kf/(2*m_p*l_p^2);

K2 = l_h*Kf/(m_c*l_c^2+2*m_p*l_h^2);

%Syst
A = [0 1 0 0 0; 0 0 0 0 0; 0 0 0 0 0; 1 0 0 0 0; 0 0 1 0 0];
%A = [0 1 0; 0 0 0; 0 0 0];
 B = [0 0; 0 K1; K2 0; 0 0; 0 0];
%B = [0 0; 0 K1; K2 0];

    

syms k_11 k_12 k_13 k_21 k_22 k_23;

%K = [k_11 k_12 k_13; k_21 k_22 k_23];

%syms p_1 p_2 p_3;

%P = [-2; -5 - 3*i; -5 + 3*i];

%K = place(A,B,P)

% --------------------------------------- LQR
Q = diag([50; 10; 1; 1; 5]);
%Q = diag([50; 10; 1]);

R = diag([.1; .5]);

K = lqr(A,B,Q,R)

k_11 = K(1,1); 
k_13 = K(1,3); 
k_21 = K(2,1); 
k_23 = K(2,3); 


F = [k_11 k_13; k_21 k_23]